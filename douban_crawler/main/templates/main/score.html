<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Home</title>
  <meta content="" name="descriptison">
  <meta content="" name="keywords">
  {% load static %}
  <!-- 图标 -->
  <link href="{% static 'main/assets/img/favicon.png' %}" rel="icon">
  <link href="{% static 'main/assets/img/apple-touch-icon.png' %}" rel="apple-touch-icon">
  <!-- 字体 -->
  <link href="{% static 'main/assets/vendor/google/fonts.css' %}" rel="stylesheet">
  <!-- 第三方CSS -->
  <link href="{% static 'main/assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'main/assets/vendor/icofont/icofont.min.css' %}" rel="stylesheet">
  <link href="{% static 'main/assets/vendor/boxicons/css/boxicons.min.css' %}" rel="stylesheet">
  <link href="{% static 'main/assets/vendor/animate.css/animate.min.css' %}" rel="stylesheet">
  <link href="{% static 'main/assets/vendor/venobox/venobox.css' %}" rel="stylesheet">
  <link href="{% static 'main/assets/vendor/aos/aos.css' %}" rel="stylesheet">
  <!-- 模版主要样式 -->
  <link href="{% static 'main/assets/css/style.css' %}" rel="stylesheet">
</head>

<body>
  <!-- ======= 头部 ======= -->
  <header id="header">
    <div class="container">
      <div class="logo float-left">
        <h1 class="text-light"><a href="{% url 'index' %}"><span>豆瓣电影TOP250</span></a></h1>
      </div>
      <nav class="nav-menu float-right d-none d-lg-block">
        <ul>
          <li><a href="{% url 'index' %}">首页 <i class="la la-angle-down"></i></a></li>
          <li><a href="{% url 'movie' %}">电影</a></li>
          <li class="active"><a href="{% url 'score' %}">统计</a></li>
          <li><a href="{% url 'word' %}">词云</a></li>
        </ul>
      </nav>

    </div>
  </header>
  <!-- ======= 主内容 ======= -->
  <div class="container">
    <!-- ======= 标题 ======= -->
    <div class="section-title">
      <h2>豆瓣电影TOP250图表展示</h2>
      <p>此页面使用Django模版/Echarts图表库实现</p>
    </div>
    <!-- ======= 图表-前十评分与评价人数 ======= -->
    <div id="charts-rating-judge" style="width: 100%;height:350px;"></div>
    <!-- ======= 图表-评分分布情况 ======= -->
    <div id="charts-rating-statistics" style="width: 100%;height:350px;"></div>
  </div>
  <!-- ======= 页脚 ======= -->
  <footer id="footer">
    <div class="container">
      <div class="copyright">&copy; 2025 by InsectMk</div>
      <div class="credits"></div>
    </div>
  </footer>

  <!-- ======= 回到顶部 ======= -->
  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>
  <!-- 第三方JS -->
  <script src="{% static 'main/assets/vendor/jquery/jquery.min.js' %}"></script>
  <script src="{% static 'main/assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'main/assets/vendor/jquery.easing/jquery.easing.min.js' %}"></script>
  <script src="{% static 'main/assets/vendor/jquery-sticky/jquery.sticky.js' %}"></script>
  <script src="{% static 'main/assets/vendor/venobox/venobox.min.js' %}"></script>
  <script src="{% static 'main/assets/vendor/waypoints/jquery.waypoints.min.js' %}"></script>
  <script src="{% static 'main/assets/vendor/counterup/counterup.min.js' %}"></script>
  <script src="{% static 'main/assets/vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>
  <script src="{% static 'main/assets/vendor/aos/aos.js' %}"></script>
  <script src="{% static 'main/assets/vendor/echarts/echarts.min.js' %}"></script>
  <!-- 模版主JS -->
  <script src="{% static 'main/assets/js/main.js' %}"></script>
</body>
</html>
<!-- 自定义JS -->
<script type="text/javascript">
// 图表-前十评分与评价人数
const chartsRatingJudge = echarts.init(document.getElementById('charts-rating-judge'))
// 图表-评分分布情况
const chartsRatingStatistics = echarts.init(document.getElementById('charts-rating-statistics'))
// 图表参数
const optionRatingJudge = {
  title: {
    text: '电影TOP10评分统计',
  },
  tooltip: {
    trigger: 'axis'
  },
  legend: {
    data: ['评分', '评价人数']
  },
  xAxis: {
    type: 'category',
    data: {{ chart_rating_judge.names|safe }}  // 电影名列表
  },
  yAxis: [
    {
      type: 'value',
      name: '评分',
      min: 0,
      max: 10,  // 评分范围0-10
      position: 'left',
      axisLabel: {
        formatter: '{value}'
      }
    },
    {
      type: 'value',
      name: '评价人数',
      min: 0,
      position: 'right',
      axisLabel: {
        formatter: '{value}'
      }
    }
  ],
  series: [
    {
      name: '评分',
      type: 'bar',
      data: {{ chart_rating_judge.ratings|safe }}  // 评分列表
    },
    {
      name: '评价人数',
      type: 'line',  // 使用折线图
      yAxisIndex: 1,
      data: {{ chart_rating_judge.num_judges|safe }}  // 评价人数列表
    }
  ],
  color: ['#66b3ff','#ff9999']  // 自定义颜色
}

const optionRatingStatistics = {
  title: {
    text: '电影评分统计',
    subtext: '豆瓣电影TOP250评分分布情况',
  },
  tooltip: {
    trigger: 'item'
  },
  legend: {
    orient: 'vertical',
    left: 'right'
  },
  series: [
    {
      name: '评分分布',
      type: 'pie',
      radius: '50%',
      data: {{ chart_rating_statistics.datas|safe }}, // 评分+计数
      emphasis: {
        itemStyle: {
          shadowBlur: 10,
          shadowOffsetX: 0,
          shadowColor: 'rgba(0, 0, 0, 0.5)'
        }
      }
    }
  ],
  color: ['#ff9999', '#66b3ff', '#99ff99', '#ffcc99', '#c2c2f0', '#ffb3e6', '#c2f0c2', '#ffccff', '#ffd699', '#ffb366']  // 自定义颜色
};
// 初始化图表
chartsRatingStatistics.setOption(optionRatingStatistics)
chartsRatingJudge.setOption(optionRatingJudge)
</script>